<html>
    <head>
        <link rel="stylesheet" href="../css/reset.css">
        <link rel="stylesheet" href="../layui/css/layui.css">
        <link rel="stylesheet" href="../css/font-awesome.min.css">
        <link rel="stylesheet" href="../css/sysBlogList.css">
        <script src="../js/jquery-3.5.1.min.js"></script>
        <script src="../layui/layui.all.js"></script>
        <script src="../js/sysBlogList.js"></script>
    </head>
    <body>
        <div class="searchWrap">
            <input type="text" class="searchInput" placeholder="请输入查询内容">
            <span class="doSearchIcon" id="doSearchIcon" onclick="search()">
                <svg t="1615025607795" class="icon" viewBox="0 0 1024 1024" 
                    version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3067" width="20" height="20">
                    <path d="M990.980258 969.944422l-185.094554-185.094554c83.911344-83.23135 135.990938-198.518449 135.990938-325.781454C941.876642 205.950391 735.934251 0 482.824228 0 229.698205 0 23.747814 205.950391 23.747814 459.076413c0 253.142022 205.950391 459.060414 459.076414 459.060414 103.079195 0 198.334451-34.167733 275.037851-91.759283l188.342529 188.342528c6.183952 6.183952 14.279888 9.271928 22.383825 9.271928s16.199873-3.087976 22.391825-9.271928a31.655753 31.655753 0 0 0 0-44.77565zM87.06732 459.076413c0-218.222295 177.534613-395.748908 395.756908-395.748908 218.206295 0 395.732908 177.526613 395.732908 395.748908 0 218.198295-177.526613 395.740908-395.732908 395.740909-218.222295 0-395.756908-177.542613-395.756908-395.740909z" fill="#777777" p-id="3068" id="searchIconSVG"></path>
                </svg>
            </span>
        </div>
        <ul class="selectWrap">
            <li class="selectItemWrap">
                <span class="selectTitle">一级分类</span>
                <div class="selectCandidateWrap">
                    <div class="selectAll">
                        <div class="selectItem selected" onclick="selectBlogBy('catagory', 0)">全部</div>
                    </div>
                    <ul class="subSelectItemWrap">
                        <li class="selectItem" onclick="selectBlogBy('catagory', 1)">技术</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 2)">生活</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">分享</li>
                    </ul>
                </div>
            </li>

            <li class="selectItemWrap">
                <span class="selectTitle">二级分类</span>
                <div class="selectCandidateWrap">
                    <div class="selectAll">
                        <div class="selectItem selected" onclick="selectBlogBy('catagory', 0)">全部</div>
                    </div>
                    <ul class="subSelectItemWrap">
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">java学习</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">计算机基础vertical</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">项目</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">刷题</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">电影</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 1)">随想集</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 2)">相册</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">音乐</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">电子书</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">刷题</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">电影</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 1)">随想集</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 2)">相册</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">音乐</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">电子书</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">刷题</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">电影</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 1)">随想集</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 2)">相册</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">音乐</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 3)">电子书</li>
                    </ul>
                </div>
            </li>

            <li class="selectItemWrap">
                <span class="selectTitle">状态</span>
                <div class="selectCandidateWrap">
                    <div class="selectAll">
                        <div class="selectItem selected" onclick="selectBlogBy('catagory', 0)">全部</div>
                    </div>
                    <ul class="subSelectItemWrap">
                        <li class="selectItem" onclick="selectBlogBy('catagory', 1)">已发布</li>
                        <li class="selectItem" onclick="selectBlogBy('catagory', 2)">草稿箱</li>
                    </ul>
                </div>
            </li>
        </ul>
        <div class="blogListWrap">
            <div style="margin-top: 100px;" id="spinner">
                <div class="spinner">
                    <div class="rect1"></div>
                    <div class="rect2"></div>
                    <div class="rect3"></div>
                    <div class="rect4"></div>
                    <div class="rect5"></div>
                </div>
            </div>
            <table class="blogTable" id="blogTable" style="display: none;">
                <tbody>
                    <tr class="tableHeader">
                        <th></th><th>标题</th><th>上传时间</th><th>一级分类</th><th>二级分类</th>
                        <th>状态</th><th>操作</th>
                    </tr>
                </tbody>
            </table>
            <div class="more">
                <a href="#" onclick="go()" class="goPre">上一页</a>
                <div class="pageInfo"><span class="curPage">1</span><span class="splitIcon">/</span><span class="allPage">10</span></div>
                <a href="#" onclick="go()" class="goNext">下一页</a>
                <div class="goWrap">
                    <input type="number" class="targetPage">
                    <button class="goBtn">跳转</button>
                </div>
            </div>
        </div>
    </body>
    <script>    
        $(()=>{
            renderTable(0, 10, 0);
        })

        function renderTable(curPage, pageSize, allSize){
            // 初始状态：表格区域播放等待动画
            let spinner = $("#spinner");
            let blogTable = $("#blogTable");
            spinner.css("display", "block");
            blogTable.css("display", "none");

            // 第一步：根据分页信息向后台请求数据
            data = [{
                    "title": "JVM运行时数据区域",
                    "id":"1001",
                    "categoryId": "1001",
                    "topicId": "2001",
                    "createTime": "2021-03-21",
                    "updateTime": "2021-03-21",
                    "headImgUrl": "../img/bk.jpg",
                    "abstract": "这是摘要，这是摘要，这是摘要，这是摘要，这是摘要，这是摘要，这是摘要，这是摘要，这是摘要，这是摘要，这是摘要，这是摘要，这是摘要",
                    "mark": [
                        {"id": "1001", "value":"spring"},
                        {"id": "1002", "value":"项目"},
                    ],
                    "visited": 101,
                    "comment": 13
                }
            ];

            // 第二步：循环渲染每一条数据
            for (let i = 0; i < data.length; i++) {
                let blogDom = renderBlog(data[i]);
                blogTable.children('tbody').append(blogDom);
            }
            // 关闭等待动画
            spinner.css("display", "none");
            blogTable.css("display", "table");
        }

        function toggleBlogInfo(dom, blogId){
            // TODO 通过blog请求后台内容
            let arrow = $(dom);
            let rowTR = arrow.parents("tr");
            let infoBox = rowTR.next().find(".blogInfoWrap");
            let loaddingIcon = infoBox.find(".spinner");
            if (infoBox.hasClass('opened')) {
                closeInfoBox(arrow, rowTR, infoBox);
                return;
            }
            openInfoBox(arrow, rowTR, infoBox);
        }
        function openInfoBox(arrow, rowTR, infoBox){
            infoBox.slideDown();
            infoBox.addClass('opened');
            rowTR.addClass("noBottomBorder");
            arrow.css("transform", "rotate(90deg)");
        }
        function closeInfoBox(arrow, rowTR, infoBox){
            infoBox.slideUp();
            infoBox.removeClass("opened");
            setTimeout(() => {
                rowTR.removeClass("noBottomBorder");
            }, 500);
            arrow.css("transform", "rotate(0deg)");
        }
    </script>
</html>